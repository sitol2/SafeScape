{% load static %}
<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEBSITE NAME</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Balsamiq+Sans:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            transition: background-color 0.5s ease-in-out;
        }
        .container { max-width: 1200px; margin: auto; }
        .kids-bg { background-color: #fff1d6; }
        .kids-font { font-family: 'Balsamiq Sans', cursive; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        .kids-card { background: linear-gradient(135deg, #FF6F61, #FFC761); }
        
        /* Custom styles for the floating chatbot */
        .chat-container { position: fixed; bottom: 2rem; right: 2rem; z-index: 100; }
        .chat-button { width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); cursor: pointer; transition: transform 0.2s ease-in-out; }
        .chat-button:hover { transform: scale(1.05); }
        .chat-window { width: 350px; height: 500px; background-color: white; border-radius: 1rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); overflow: hidden; flex-direction: column; position: absolute; right: 0; bottom: calc(100% + 1rem); transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out; transform: scale(0.1); transform-origin: bottom right; opacity: 0; pointer-events: none; }
        .chat-window.open { transform: scale(1); opacity: 1; pointer-events: auto; }

        /* Styles for the Coloring Game */
        #coloringCanvas {
            border: 2px solid #374151;
            cursor: crosshair;
            background-color: #ffffff;
            touch-action: none;
            border-radius: 0.75rem;
        }
        .color-btn {
            border: 2px solid transparent;
        }
        .color-btn.active {
            border-color: #374151;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="container p-4 md:p-8">

        <nav class="flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-xl shadow-lg mb-8">
            <h1 class="text-3xl font-bold text-red-600 mb-4 md:mb-0">WEBSITE NAME</h1>
            <div class="flex flex-wrap justify-center md:space-x-4 space-x-2">
                <button id="btn-professionals" class="px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-red-600 text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50">Professionals</button>
                <button id="btn-adults" class="px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-gray-200 text-gray-700 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">Adults</button>
                <button id="btn-kids" class="px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-gray-200 text-gray-700 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">Kids</button>
            </div>
        </nav>

        <main id="content-section" class="space-y-8"></main>
        
        <section id="coloring-section" class="hidden">
            <div class="bg-white rounded-xl shadow-lg p-6 max-w-4xl w-full flex flex-col items-center mx-auto">
                <h1 class="text-3xl font-bold mb-4 text-gray-800 kids-font">Coloring Corner!</h1>
                <div class="mb-4 text-gray-600">
                    <span class="mr-2 font-semibold">Choose a picture:</span>
                    <div class="flex flex-wrap justify-center gap-2">
                        <button class="select-btn px-4 py-2 rounded-full bg-blue-500 text-white font-semibold shadow-md transform transition duration-200 hover:scale-105 active:scale-95" data-image="{% static 'resources/images/Fire Extinguisher.JPEG' %}">1</button>
                        <button class="select-btn px-4 py-2 rounded-full bg-green-500 text-white font-semibold shadow-md transform transition duration-200 hover:scale-105 active:scale-95" data-image="{% static 'resources/images/Water Bucket.JPEG' %}">2</button>
                    </div>
                </div>
                <canvas id="coloringCanvas" class="mb-4 aspect-video w-full max-w-2xl"></canvas>
                <div class="flex flex-wrap justify-center gap-2 mb-4">
                    <button class="color-btn w-10 h-10 rounded-full bg-red-500 shadow-md transform transition duration-200 hover:scale-110 active:scale-95 border-2 border-gray-300 active" data-color="#ef4444"></button>
                    <button class="color-btn w-10 h-10 rounded-full bg-blue-500 shadow-md transform transition duration-200 hover:scale-110 active:scale-95 border-2 border-gray-300" data-color="#3b82f6"></button>
                    <button class="color-btn w-10 h-10 rounded-full bg-green-500 shadow-md transform transition duration-200 hover:scale-110 active:scale-95 border-2 border-gray-300" data-color="#22c55e"></button>
                    <button class="color-btn w-10 h-10 rounded-full bg-yellow-500 shadow-md transform transition duration-200 hover:scale-110 active:scale-95 border-2 border-gray-300" data-color="#eab308"></button>
                    <button class="color-btn w-10 h-10 rounded-full bg-purple-500 shadow-md transform transition duration-200 hover:scale-110 active:scale-95 border-2 border-gray-300" data-color="#a855f7"></button>
                    <button class="color-btn w-10 h-10 rounded-full bg-gray-900 shadow-md transform transition duration-200 hover:scale-110 active:scale-95 border-2 border-gray-300" data-color="#1f2937"></button>
                    <!-- This button is now the dedicated eraser -->
                    <!-- <button id="eraserBtn" class="w-10 h-10 rounded-full shadow-md transform transition duration-200 hover:scale-110 active:scale-95 bg-gray-200 border-2 border-gray-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto text-gray-800" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                    </button> -->
                </div>
                <div class="mb-4 text-gray-600 w-full max-w-sm">
                    <label for="brushSize" class="block mb-1 text-center font-semibold">Brush Size</label>
                    <input type="range" id="brushSize" min="1" max="20" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                </div>
                <div class="flex gap-4">
                    <button id="clearBtn" class="px-6 py-2 rounded-full bg-orange-500 text-white font-semibold shadow-md transform transition duration-200 hover:scale-105 active:scale-95">Clear Coloring</button>
                    <button onclick="exitGame()" class="px-6 py-2 rounded-full font-semibold bg-red-600 text-white hover:bg-red-700 transition">Back to Kids Menu</button>
                </div>
            </div>
        </section>

    </div>

    <div class="chat-container">
      <button id="chatbot-toggle-btn" class="chat-button bg-red-600 text-white hover:bg-red-700">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8"><path fill-rule="evenodd" d="M4.848 9.044a.75.75 0 01.447.803l-2.585 9.406a.75.75 0 01-1.353-.372L.373 11.2a1.5 1.5 0 011.06-1.925l8.77-2.175a.75.75 0 01-.274 1.488l-5.748 1.424zM11.516 1.405a.75.75 0 01.372 1.353l-9.406 2.585a.75.75 0 01-.803-.447l-1.925-8.77a1.5 0 011.925-1.06l8.77 1.925z" clip-rule="evenodd" /><path d="M11.516 1.405a.75.75 0 01.372 1.353l-9.406 2.585a.75.75 0 01-.803-.447l-1.925-8.77a1.5 1.5 0 011.925-1.06l8.77 1.925z" /><path d="M12.915 2.176a.75.75 0 00-.77 1.258l2.175 5.748a.75.75 0 001.258-.77l-2.585-9.406a.75.75 0 00-1.258.77l-9.406 2.585a.75.75 0 00-.77 1.258l-5.748-2.175a.75.75 0 00-1.258.77l9.406 2.585a.75.75 0 00.77-1.258l2.175-5.748a.75.75 0 001.258.77z" /><path d="M12.915 2.176a.75.75 0 00-.77 1.258l2.175 5.748a.75.75 0 001.258-.77l-2.585-9.406a.75.75 0 00-1.258.77l-9.406 2.585a.75.75 0 00-.77 1.258l-5.748-2.175a.75.75 0 00-1.258.77l9.406 2.585a.75.75 0 00.77-1.258l2.175-5.748a.75.75 0 001.258.77z" /></svg>
      </button>
      <div id="chatbot-window" class="chat-window">
        <div class="flex flex-col h-full bg-gray-100 rounded-xl shadow-lg overflow-hidden">
          <div class="bg-white p-4 flex items-center justify-between shadow-sm">
            <div class="flex items-center space-x-3"><img src="https://placehold.co/40x40/c026d3/ffffff?text=AI" alt="Chatbot Avatar" class="rounded-full"><div><h2 class="font-bold text-gray-900">BFP Assistant</h2><p class="text-sm text-gray-500">Chatbot</p></div></div>
            <button id="chat-close-btn" class="text-gray-400 hover:text-gray-600"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z" clip-rule="evenodd" /></svg></button>
          </div>
          <div class="flex-1 p-4 overflow-y-auto space-y-4">
            <!-- Quick questions will be dynamically inserted here by JavaScript -->
          </div>
          <div class="bg-white p-4 border-t border-gray-200 flex items-center space-x-4">
            <input type="text" placeholder="Type a message..." class="flex-1 p-3 rounded-full bg-gray-100 focus:outline-none focus:ring-2 focus:ring-red-500">
            <button class="bg-red-600 text-white p-3 rounded-full hover:bg-red-700 transition"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.917H13.5a.75.75 0 010 1.5H4.984l-2.432 7.917a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z" /></svg></button>
          </div>
        </div>
      </div>
    </div>

    <template id="tmpl-professionals">
      <section class="rounded-2xl overflow-hidden shadow-xl mb-8">
        <div class="bg-[#0b1b3b] text-white p-8 md:p-12">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-8">
            <div>
              <h5 class="text-3xl font-Arial tracking-tight">Republic of the Philippines</h5>
              <h2 class="text-4xl font-extrabold tracking-tight">BUREAU OF FIRE PROTECTION STA. CRUZ</h2>
              <p class="mt-3 text-white/80 text-lg max-w-2xl">Proactive fire safety with analytics, digital twins, and training—built for real operations.</p>
              <div class="mt-6 flex flex-wrap gap-3">
                <a href="#" class="inline-block px-5 py-2.5 rounded-lg font-semibold bg-orange-500 hover:bg-orange-600 transition">Explore Modules</a>
                <a href="#" class="inline-block px-5 py-2.5 rounded-lg font-semibold bg-white/10 hover:bg-white/20 transition">View Demo</a>
              </div>
            </div>
            <div class="w-full md:w-96"><img src="https://placehold.co/600x400/0b1b3b/ffffff?text=Operations+overview" alt="Operations overview" class="rounded-xl w-full h-56 object-cover ring-1 ring-white/10"></div>
          </div>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 bg-white">
          <div class="p-5 text-center"><div class="text-3xl font-extrabold text-[#0b1b3b]">82%</div><div class="text-sm text-gray-600">Random Data 1</div></div>
          <div class="p-5 text-center"><div class="text-3xl font-extrabold text-[#0b1b3b]">120+</div><div class="text-sm text-gray-600">Random Data 2</div></div>
          <div class="p-5 text-center"><div class="text-3xl font-extrabold text-[#0b1b3b]">24/7</div><div class="text-sm text-gray-600">Random Data 3</div></div>
          <div class="p-5 text-center"><div class="text-3xl font-extrabold text-[#0b1b3b]">5 min</div><div class="text-sm text-gray-600">Random Data 4</div></div>
        </div>
      </section>
      <section class="rounded-xl border border-orange-200 bg-orange-50 p-5 mb-8">
        <div class="flex items-start gap-3">
          <div class="mt-1 h-2.5 w-2.5 rounded-full bg-orange-500"></div>
          <div>
            <h3 class="font-semibold text-orange-700">ALERT TAB</h3>
            <p class="text-sm text-orange-700/90">blah blah blah.</p>
          </div>
        </div>
      </section>
      <section class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <article class="bg-white rounded-xl shadow-lg overflow-hidden ring-1 ring-gray-100">
          <img src="https://placehold.co/600x400/e2e8f0/64748b?text=AI+analytics" alt="AI analytics" class="w-full h-44 object-cover">
          <div class="p-6">
            <span class="inline-block text-xs font-semibold px-2 py-1 rounded bg-blue-50 text-blue-700">Risk Intelligence</span>
            <h4 class="mt-3 text-2xl font-bold text-gray-900">AI-Powered Risk Assessment</h4>
            <p class="mt-2 text-gray-700">Forecast hotspots from historical incidents, occupancy, and weather. Prioritize inspections proactively.</p>
            <a href="#" class="mt-4 inline-block font-semibold text-orange-600 hover:text-orange-700">Learn more →</a>
          </div>
        </article>
        <article class="bg-white rounded-xl shadow-lg overflow-hidden ring-1 ring-gray-100">
          <img src="https://placehold.co/600x400/e2e8f0/64748b?text=Digital+twin" alt="Digital twin" class="w-full h-44 object-cover">
          <div class="p-6">
            <span class="inline-block text-xs font-semibold px-2 py-1 rounded bg-indigo-50 text-indigo-700">Situational Awareness</span>
            <h4 class="mt-3 text-2xl font-bold text-gray-900">Digital Twin & IoT</h4>
            <p class="mt-2 text-gray-700">Live sensors feed a 2D twin of streets and facilities. Track smoke, heat, and hydrant status.</p>
            <a href="#" class="mt-4 inline-block font-semibold text-orange-600 hover:text-orange-700">Explore features →</a>
          </div>
        </article>
        <article class="bg-white rounded-xl shadow-lg overflow-hidden ring-1 ring-gray-100">
          <img src="https://placehold.co/600x400/e2e8f0/64748b?text=VR/AR+training" alt="VR/AR training" class="w-full h-44 object-cover">
          <div class="p-6">
            <span class="inline-block text-xs font-semibold px-2 py-1 rounded bg-emerald-50 text-emerald-700">Training</span>
            <h4 class="mt-3 text-2xl font-bold text-gray-900">Immersive VR/AR Drills</h4>
            <p class="mt-2 text-gray-700">Practice suppression, SCBA checks, and evacuations in repeatable, risk-free scenarios.</p>
            <a href="#" class="mt-4 inline-block font-semibold text-orange-600 hover:text-orange-700">View demo →</a>
          </div>
        </article>
        <article class="bg-white rounded-xl shadow-lg overflow-hidden ring-1 ring-gray-100">
          <img src="https://placehold.co/600x400/e2e8f0/64748b?text=Outreach+analytics" alt="Outreach analytics" class="w-full h-44 object-cover">
          <div class="p-6">
            <span class="inline-block text-xs font-semibold px-2 py-1 rounded bg-amber-50 text-amber-700">Engagement</span>
            <h4 class="mt-3 text-2xl font-bold text-gray-900">Community Outreach Analytics</h4>
            <p class="mt-2 text-gray-700">Measure campaign reach and drill participation. Focus on barangays that need help most.</p>
            <a href="#" class="mt-4 inline-block font-semibold text-orange-600 hover:text-orange-700">Access dashboard →</a>
          </div>
        </article>
      </section>
      <p class="mt-6 text-xs text-gray-500">demo palang.</p>
    </template>

    <script>
        const contentSection = document.getElementById('content-section');
        const professionalBtn = document.getElementById('btn-professionals');
        const adultsBtn = document.getElementById('btn-adults');
        const kidsBtn = document.getElementById('btn-kids');
        const body = document.body;
        const gameSection = document.getElementById('coloring-section');

        // --- START OF INTEGRATED COLORING GAME SCRIPT ---
        const canvas = document.getElementById('coloringCanvas');
        const ctx = canvas ? canvas.getContext('2d') : null;
        const brushSizeInput = document.getElementById('brushSize');
        const eraserBtn = document.getElementById('eraserBtn');
        let isDrawing = false;
        let currentColor = '#1f2937';
        let brushSize = 5;
        let currentImage = "{% static 'resources/images/Fire Extinguisher.JPEG' %}"; 

        function loadImageOutline(imagePath) {
            if (!ctx) return;
            const img = new Image();
            img.src = imagePath;
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            };
            img.onerror = () => { console.error(`Failed to load image at: ${imagePath}`); };
        }
        
        function setCanvasSize() {
            if (!canvas) return;
            const container = canvas.parentElement;
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetWidth * (9 / 16);
            loadImageOutline(currentImage);
        }

        function getCoords(event) {
            const rect = canvas.getBoundingClientRect();
            let x, y;
            if (event.touches) {
                x = event.touches[0].clientX - rect.left;
                y = event.touches[0].clientY - rect.top;
            } else {
                x = event.clientX - rect.left;
                y = event.clientY - rect.top;
            }
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            return { x: x * scaleX, y: y * scaleY };
        }
        
        function startDrawing(event) {
            isDrawing = true;
            const { x, y } = getCoords(event);
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function draw(event) {
            if (!isDrawing) return;
            event.preventDefault(); 
            const { x, y } = getCoords(event);
            ctx.lineTo(x, y);
            ctx.strokeStyle = currentColor;
            ctx.lineWidth = brushSize;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function stopDrawing() {
            isDrawing = false;
            ctx.closePath();
        }

        if (canvas) {
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseleave', stopDrawing);
            canvas.addEventListener('touchstart', startDrawing, { passive: false });
            canvas.addEventListener('touchmove', draw, { passive: false });
            canvas.addEventListener('touchend', stopDrawing);
            window.addEventListener('resize', setCanvasSize);
        }

        // Color button click listener
        document.querySelectorAll('.color-btn').forEach(button => {
            button.addEventListener('click', (event) => {
                currentColor = event.currentTarget.dataset.color;
                // Switch back to painting mode when a color is selected
                ctx.globalCompositeOperation = 'source-over';
                document.querySelectorAll('.color-btn, #eraserBtn').forEach(btn => btn.classList.remove('active'));
                event.currentTarget.classList.add('active');
            });
        });
        
        // Eraser button click listener
        if (eraserBtn) {
            eraserBtn.addEventListener('click', () => {
                // This is the key change: 'destination-out' erases existing content
                ctx.globalCompositeOperation = 'destination-out';
                document.querySelectorAll('.color-btn, #eraserBtn').forEach(btn => btn.classList.remove('active'));
                eraserBtn.classList.add('active');
            });
        }

        document.querySelectorAll('.select-btn').forEach(button => {
            button.addEventListener('click', (event) => {
                currentImage = event.target.dataset.image;
                loadImageOutline(currentImage);
            });
        });

        if (brushSizeInput) {
            brushSizeInput.addEventListener('input', (event) => {
                brushSize = parseInt(event.target.value);
            });
        }

        const clearBtn = document.getElementById('clearBtn');
        if (clearBtn) {
            clearBtn.addEventListener('click', () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                loadImageOutline(currentImage);
            });
        }
        // --- END OF INTEGRATED COLORING GAME SCRIPT ---


        // --- ORIGINAL WEBSITE SCRIPT ---
        const contentData = {
            adults: {
                title: "Fire Safety for Home & Family",
                subtitle: "Empowering households with practical fire safety knowledge.",
                className: "adult-section",
                sections: [
                    { title: "Home Risk Assessment", text: "Our interactive tool guides you...", image: "https://placehold.co/600x400/e2e8f0/64748b?text=Home+Assessment", link: "#", linkText: "Start Assessment" },
                    { title: "Essential Safety Guides", text: "Access easy-to-understand guides...", image: "https://placehold.co/600x400/e2e8f0/64748b?text=Safety+Guides", link: "#", linkText: "View Guides" },
                    { title: "Family Preparedness", text: "Learn how to conduct effective fire drills...", image: "https://placehold.co/600x400/e2e8f0/64748b?text=Family+Prep", link: "#", linkText: "Get Started" },
                    { title: "Connect with the BFP", text: "Find contact info and events...", image: "https://placehold.co/600x400/e2e0e0/262626?text=BFP+Info", link: "#", linkText: "Find Your Station" }
                ]
            },
            kids: {
                title: "Fire Safety Adventures!",
                subtitle: "Become a fire safety hero with games and stories.",
                className: "kids-section",
                sections: [
                    { title: "Hero's Academy", text: "Join our Filipino fire safety hero...", image: "https://placehold.co/600x400/ff9955/262626?text=Filipino+Hero", link: "/kids/hero-academy/", linkText: "Start the Adventure" },
                    { title: "Coloring Corner", text: "Grab your virtual crayons!", image: "https://placehold.co/600x400/b3e5fc/262626?text=Coloring+Corner", link: "javascript:void(0)", linkText: "Color Now!", onClick: "startGame()"  },
                    { title: "Safety Puzzles", text: "Solve puzzles to learn safety rules.", image: "https://placehold.co/600x400/66bb6a/262626?text=Safety+Puzzles", link: "#", linkText: "Play Now!" },
                    { title: "Fire Fighter Game", text: "Test your skills and put out fires in our new game!", image: "https://placehold.co/600x400/e0e0e0/262626?text=Game+Placeholder", link: "#", linkText: "Play Now!"}
                ]
            }
        };

        function updateUI(userGroup) {
            gameSection.classList.add('hidden');
            contentSection.classList.remove('hidden');
            if (userGroup === 'professionals') {
                const tpl = document.getElementById('tmpl-professionals');
                contentSection.innerHTML = tpl.innerHTML;
                body.classList.remove('kids-bg');
                body.classList.add('bg-gray-100');
                return;
            }

            const data = contentData[userGroup];
            let htmlContent = `
                <section class="p-6 rounded-xl shadow-lg text-center mb-8 bg-white ${userGroup === 'kids' ? 'kids-font' : ''}">
                    <h2 class="text-4xl font-extrabold text-red-600 mb-2">${data.title}</h2>
                    <p class="text-lg text-gray-600">${data.subtitle}</p>
                </section>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            `;
            data.sections.forEach(section => {
                htmlContent += `
                    <div class="rounded-xl shadow-lg overflow-hidden flex flex-col md:flex-row ${userGroup === 'kids' ? 'kids-card' : 'bg-white'}">
                        <div class="w-full md:w-1/2 p-4"><img src="${section.image}" alt="${section.title}" class="rounded-lg mb-4 object-cover w-full h-48 md:h-full"></div>
                        <div class="w-full md:w-1/2 p-6 flex flex-col justify-between">
                            <div>
                                <h3 class="text-2xl font-bold text-gray-900 mb-2 ${userGroup === 'kids' ? 'kids-font' : ''}">${section.title}</h3>
                                <p class="text-gray-700 mb-4">${section.text}</p>
                            </div>
                            <a href="${section.link}" onclick="${section.onClick || ''}" class="inline-block px-4 py-2 text-center rounded-full font-semibold text-white bg-red-600 hover:bg-red-700 transition">${section.linkText}</a>
                        </div>
                    </div>
                `;
            });
            htmlContent += `</div>`;
            contentSection.innerHTML = htmlContent;

            body.classList.remove('kids-bg', 'text-gray-800');
            if (userGroup === 'kids') {
                body.classList.add('kids-bg');
            } else {
                body.classList.add('bg-gray-100');
            }
        }

        function handleButtonClick(event) {
            [professionalBtn, adultsBtn, kidsBtn].forEach(btn => {
                btn.classList.remove('bg-red-600', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            event.target.classList.remove('bg-gray-200', 'text-gray-700');
            event.target.classList.add('bg-red-600', 'text-white');
            const userGroup = event.target.id.replace('btn-', '');
            updateUI(userGroup);
        }

        professionalBtn.addEventListener('click', handleButtonClick);
        adultsBtn.addEventListener('click', handleButtonClick);
        kidsBtn.addEventListener('click', handleButtonClick);

        window.onload = () => { updateUI('professionals'); };

        // --- GAME CONTROL FUNCTIONS ---
        function startGame() {
            contentSection.classList.add('hidden');
            gameSection.classList.remove('hidden');
            setCanvasSize();
            // Start with a default color selected and drawing mode enabled
            const firstColorButton = document.querySelector('.color-btn');
            if (firstColorButton) {
                document.querySelectorAll('.color-btn, #eraserBtn').forEach(btn => btn.classList.remove('active'));
                firstColorButton.classList.add('active');
                currentColor = firstColorButton.dataset.color;
                ctx.globalCompositeOperation = 'source-over';
            }
        }

        function exitGame() {
            gameSection.classList.add('hidden');
            contentSection.classList.remove('hidden');
        }
    </script>
    <script src="{% static 'js/chatbot.js' %}"></script>
</body>
</html>
